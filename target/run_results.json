{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-01-13T15:10:54.225168Z", "invocation_id": "4685c1d6-d841-4cb9-8bee-a034c20e5dad", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-13T15:10:44.958774Z", "completed_at": "2025-01-13T15:10:44.977750Z"}, {"name": "execute", "started_at": "2025-01-13T15:10:45.029749Z", "completed_at": "2025-01-13T15:10:50.448445Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.515122890472412, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-analytics-392621", "job_id": "4e69ea61-3cfa-4b5b-9a51-2ae03ae93ed6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_sumup.stg_leads_funnel", "compiled": true, "compiled_code": "WITH cleaned_leads_funnel AS (\n    SELECT\n        DATE AS lead_activity_date,\n        COUNTRY_CODE AS country_code,\n        CAMPAIGN_ID AS campaign_id,\n        PRODUCT AS product,\n        CHANNEL_3 AS channel_level_3,\n        CHANNEL_4 AS channel_level_4,\n        CHANNEL_5 AS channel_level_5,\n        TOTAL_IMPRESSIONS AS total_impressions,\n        TOTAL_CLICKS AS total_clicks,\n        TOTAL_SPEND AS total_spend,\n        TOTAL_LEADS AS total_leads,\n        TOTAL_FAKE_LEADS AS total_fake_leads,\n        TOTAL_SQLS AS total_sqls,\n        TOTAL_MEETING_DONE AS total_meeting_done,\n        TOTAL_SIGNED_LEADS AS total_signed_leads,\n        TOTAL_POS_LITE_DEALS AS total_pos_lite_deals\n    FROM `dbt-analytics-392621`.`raw_data`.`leads_funnel`\n)\n\nSELECT * FROM cleaned_leads_funnel", "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`stg_leads_funnel`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-13T15:10:44.969749Z", "completed_at": "2025-01-13T15:10:45.013753Z"}, {"name": "execute", "started_at": "2025-01-13T15:10:45.035754Z", "completed_at": "2025-01-13T15:10:50.449423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.516127109527588, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-analytics-392621", "job_id": "419985d3-f9c8-4701-9ff4-8443ba17f519", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_sumup.stg_web_orders", "compiled": true, "compiled_code": "WITH cleaned_web_orders AS (\n    SELECT\n        DATE AS activity_date,\n        COUNTRY_CODE AS country_code,\n        CAMPAIGN_ID AS campaign_id,\n        TOTAL_SPEND_EUR AS total_spend_eur,\n        NB_OF_SESSIONS AS nb_of_sessions,\n        NB_OF_SIGNUPS AS nb_of_signups,\n        NB_OF_ORDERS AS nb_of_orders,\n        NB_OF_POSLITE_ITEMS_ORDERED AS nb_of_poslite_items_ordered,\n        NB_POSLITE_ITEMS_DISPATCHED AS nb_poslite_items_dispatched\n    FROM `dbt-analytics-392621`.`raw_data`.`web_orders`\n)\n\nSELECT * FROM cleaned_web_orders", "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`stg_web_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-13T15:10:44.942354Z", "completed_at": "2025-01-13T15:10:44.975751Z"}, {"name": "execute", "started_at": "2025-01-13T15:10:44.978751Z", "completed_at": "2025-01-13T15:10:50.451445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.5181214809417725, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-analytics-392621", "job_id": "b87173e4-b66b-480e-b4c6-7d6fbeded1cf", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_sumup.stg_channels", "compiled": true, "compiled_code": "WITH cleaned_channels AS (\n    SELECT\n        CAMPAIGN_ID AS campaign_id,\n        CAMPAIGN_NAME AS campaign_name,\n        CAMPAIGN_PERIOD_BUDGET_CATEGORY AS budget_category,\n        CHANNEL_3 AS channel_level_3,\n        CHANNEL_4 AS channel_level_4,\n        CHANNEL_5 AS channel_level_5\n    FROM `dbt-analytics-392621`.`raw_data`.`channels`\n)\n\nSELECT * FROM cleaned_channels", "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`stg_channels`", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-01-13T15:10:50.535602Z", "completed_at": "2025-01-13T15:10:50.590601Z"}, {"name": "execute", "started_at": "2025-01-13T15:10:50.591603Z", "completed_at": "2025-01-13T15:10:51.706456Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.398855209350586, "adapter_response": {}, "message": "Database Error in model mart_web_orders (models\\mart\\mart_web_orders.sql)\n  No matching signature for function SAFE_DIVIDE\n    Argument types: STRING, INT64\n    Signature: SAFE_DIVIDE(FLOAT64, FLOAT64)\n      Argument 1: Unable to coerce type STRING to expected type FLOAT64\n    Signature: SAFE_DIVIDE(NUMERIC, NUMERIC)\n      Argument 1: Unable to coerce type STRING to expected type NUMERIC\n    Signature: SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC)\n      Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC at [29:9]\n  compiled code at target\\run\\dbt_sumup\\models\\mart\\mart_web_orders.sql", "failures": null, "unique_id": "model.dbt_sumup.mart_web_orders", "compiled": true, "compiled_code": "WITH web_order_metrics AS (\n    SELECT\n        wo.activity_date,\n        wo.country_code,\n        wo.campaign_id,\n        ch.channel_level_3,\n        ch.channel_level_4,\n        ch.channel_level_5,\n        wo.nb_of_sessions,\n        wo.nb_of_signups,\n        wo.nb_of_orders,\n        wo.nb_of_poslite_items_ordered,\n        wo.nb_poslite_items_dispatched,\n        wo.total_spend_eur,\n        \n        -- Click Through Rate (CTR)\n        SAFE_DIVIDE(wo.nb_of_signups, wo.nb_of_sessions) * 100 AS ctr,\n        \n        -- Costo por orden\n        SAFE_DIVIDE(wo.total_spend_eur, wo.nb_of_orders) AS cost_per_order\n    FROM `dbt-analytics-392621`.`pos_lite_dbt`.`stg_web_orders` wo\n    LEFT JOIN `dbt-analytics-392621`.`pos_lite_dbt`.`stg_channels` ch\n      ON wo.campaign_id = ch.campaign_id\n)\nSELECT * FROM web_order_metrics", "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`mart_web_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-13T15:10:50.494603Z", "completed_at": "2025-01-13T15:10:50.505604Z"}, {"name": "execute", "started_at": "2025-01-13T15:10:50.508604Z", "completed_at": "2025-01-13T15:10:54.197296Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.707691192626953, "adapter_response": {"_message": "CREATE TABLE (3.7k rows, 530.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3736, "bytes_processed": 542919, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-analytics-392621", "job_id": "b6abc1a8-9af2-4a25-87e7-192e50f3fe4a", "slot_ms": 4612}, "message": "CREATE TABLE (3.7k rows, 530.2 KiB processed)", "failures": null, "unique_id": "model.dbt_sumup.mart_leads_funnel", "compiled": true, "compiled_code": "WITH lead_metrics AS (\n    SELECT\n        lead_activity_date AS activity_date,\n        country_code,\n        campaign_id,\n        product,\n        channel_level_3,\n        channel_level_4,\n        channel_level_5,\n        total_leads,\n        total_fake_leads,\n        total_sqls,\n        total_meeting_done,\n        total_signed_leads,\n        total_pos_lite_deals,\n        total_spend,\n        total_impressions,\n        total_clicks,\n        \n        -- Tasa de conversi\u00f3n de leads a SQLs\n        SAFE_DIVIDE(total_sqls, total_leads) * 100 AS conversion_rate_sqls,\n        \n        -- Tasa de conversi\u00f3n de SQLs a reuniones\n        SAFE_DIVIDE(total_meeting_done, total_sqls) * 100 AS conversion_rate_meetings,\n        \n        -- Tasa de conversi\u00f3n de reuniones a acuerdos firmados\n        SAFE_DIVIDE(total_signed_leads, total_meeting_done) * 100 AS conversion_rate_signed_leads,\n                \n        -- Tasa de conversi\u00f3n de acuerdos firmados a deals for POS Lite\n        SAFE_DIVIDE(total_pos_lite_deals, total_signed_leads) * 100 AS conversion_rate_pos_deals,\n        \n        -- Tasa de conversi\u00f3n de leads a deals finales\n        SAFE_DIVIDE(total_pos_lite_deals, total_leads) * 100 AS conversion_rate_deals,\n        \n        -- Costo por lead\n        SAFE_DIVIDE(total_spend, total_leads) AS cost_per_lead,\n\n        -- Costo por deal for POS Lite\n        SAFE_DIVIDE(total_spend, total_pos_lite_deals) AS cost_per_deal,\n\n        -- Click Through Rate (CTR)\n        SAFE_DIVIDE(total_clicks, total_impressions) * 100 AS ctr\n    FROM `dbt-analytics-392621`.`pos_lite_dbt`.`stg_leads_funnel`\n)\n\nSELECT * FROM lead_metrics", "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`mart_leads_funnel`", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_sumup.mart_combined_analysis", "compiled": false, "compiled_code": null, "relation_name": "`dbt-analytics-392621`.`pos_lite_dbt`.`mart_combined_analysis`", "batch_results": null}], "elapsed_time": 10.85094928741455, "args": {"introspect": true, "quiet": false, "profiles_dir": "C:\\Users\\Lenovo\\.dbt", "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "log_level_file": "debug", "partial_parse_file_diff": true, "select": [], "show_resource_report": false, "cache_selected_only": false, "macro_debugging": false, "log_format": "default", "log_format_file": "debug", "use_colors": true, "state_modified_compare_more_unrendered_values": false, "log_level": "info", "print": true, "printer_width": 80, "strict_mode": false, "exclude": [], "vars": {}, "which": "run", "indirect_selection": "eager", "send_anonymous_usage_stats": true, "static_parser": true, "write_json": true, "log_path": "C:\\Users\\Lenovo\\Documents\\Gonza\\Trabajo\\Ejercicios\\SumUp\\dbt_sumup\\logs", "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse": true, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "project_dir": "C:\\Users\\Lenovo\\Documents\\Gonza\\Trabajo\\Ejercicios\\SumUp\\dbt_sumup", "require_nested_cumulative_type_params": false, "source_freshness_run_project_hooks": false, "invocation_command": "dbt run", "require_resource_names_without_spaces": false, "version_check": true, "empty": false, "favor_state": false}}